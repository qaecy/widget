import{a as D}from"./chunk-5ZRY3FKR.js";import{a as re}from"./chunk-UNKLUZVL.js";import"./chunk-VEDCF245.js";import{g as T,h as p,i as B}from"./chunk-6GDG4PDN.js";import{o as ie}from"./chunk-QK5VUW5Z.js";import{a as me}from"./chunk-RP6GSRQV.js";import"./chunk-22TYSVVA.js";import"./chunk-PIYCZUTI.js";import"./chunk-6HG62L4Z.js";import{H as ae,U as oe,X as se,Y as le,Z as ce}from"./chunk-XKKDWFIZ.js";import"./chunk-HU7WFQWJ.js";import{j as ne}from"./chunk-4HBM54OK.js";import{Ab as l,Ka as o,Mb as v,Ob as Q,P as z,Pb as W,Q as q,Qa as Z,S as d,Ta as h,Y as P,Ya as _,Yb as ee,Z as C,Za as Y,_ as x,ab as K,ac as F,bb as u,bc as k,ec as te,fa as U,ga as j,gb as $,hb as y,ia as L,ib as I,ja as O,jb as E,ka as H,kb as J,mb as m,qa as G,rb as s,sb as r,tb as c,xb as w,zb as S}from"./chunk-C37SL542.js";import"./chunk-NC2NMBFO.js";import"./chunk-LOUWY4NJ.js";import"./chunk-4JUNAGW5.js";import"./chunk-RIETPOXV.js";import"./chunk-5W727OWZ.js";import"./chunk-SXCIL3LG.js";import"./chunk-I7PEP2DU.js";import{h as N}from"./chunk-TJICSKBO.js";function _e(t,f){t&1&&c(0,"div",2)}var ye=new q("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var pe=(()=>{class t{_elementRef=d(H);_ngZone=d(j);_changeDetectorRef=d(ee);_renderer=d(Z);_cleanupTransitionEnd;_animationMode=d(G,{optional:!0});constructor(){let e=d(ye,{optional:!0});this._isNoopAnimation=this._animationMode==="NoopAnimations",e&&(e.color&&(this.color=this._defaultColor=e.color),this.mode=e.mode||this.mode)}_isNoopAnimation=!1;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";get value(){return this._value}set value(e){this._value=de(e||0),this._changeDetectorRef.markForCheck()}_value=0;get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=de(e||0),this._changeDetectorRef.markForCheck()}_bufferValue=0;animationEnd=new U;get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}_mode="determinate";ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._cleanupTransitionEnd=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._transitionendHandler)})}ngOnDestroy(){this._cleanupTransitionEnd?.()}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}_transitionendHandler=e=>{this.animationEnd.observers.length===0||!e.target||!e.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))};static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(n,i){n&2&&($("aria-valuenow",i._isIndeterminate()?null:i.value)("mode",i.mode),J("mat-"+i.color),E("_mat-animation-noopable",i._isNoopAnimation)("mdc-linear-progress--animation-ready",!i._isNoopAnimation)("mdc-linear-progress--indeterminate",i._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",F],bufferValue:[2,"bufferValue","bufferValue",F],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[K],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(n,i){n&1&&(s(0,"div",0),c(1,"div",1),u(2,_e,1,0,"div",2),r(),s(3,"div",3),c(4,"span",4),r(),s(5,"div",5),c(6,"span",4),r()),n&2&&(o(),I("flex-basis",i._getBufferBarFlexBasis()),o(),m(i.mode==="buffer"?2:-1),o(),I("transform",i._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height, 4px),var(--mdc-linear-progress-active-indicator-height, 4px))}@media(forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height, 4px);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-sys-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}@media(forced-colors: active){.mdc-linear-progress__buffer-dots{background-color:ButtonBorder}}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height, 4px) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0})}return t})();function de(t,f=0,e=100){return Math.max(f,Math.min(e,t))}var fe=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=Y({type:t});static \u0275inj=z({imports:[ae]})}return t})();function he(t,f){if(t&1){let e=w();s(0,"lib-simple-table",1),S("contentChanged",function(i){C(e);let a=l();return x(a.onContentChange(i))}),r()}if(t&2){let e=l();y("displayFilter",!1)("data",e.tableData())("columnDefs",e.columnDefs)}}var ue=(()=>{class t{list=O.required();tableData=h([]);columnDefs=[];filteredList=L();ngOnChanges(){let e=new p("sync","Sync","right");e.type=T.CHECKBOX,e.editable=!0;let n=new p("open","","center");n.type=T.HTMLELEMENT,this.columnDefs=[new p("name","Name"),new p("modified","Modified"),n,e];let i=this.list().filter(a=>a.outdated).map(a=>{let{iri:M,size:R,modified:X,name:A}=a,g=document.createElement("button");return g.innerText="open",g.style.background="rgba(0,0,0,0)",g.style.border="1px solid",g.style.cursor="pointer",g.style.borderRadius="2px",g.addEventListener("click",()=>{window.open(M,"_blank")}),{id:M,size:R,modified:D(X),name:A,sync:!0,open:g}});this.tableData.update(()=>[...i])}onContentChange(e){let n=e.filter(a=>a.sync).map(a=>a.id),i=this.list().filter(a=>n.includes(a.iri));this.filteredList.emit(i)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["app-sync-list"]],inputs:{list:[1,"list"]},outputs:{filteredList:"filteredList"},features:[P],decls:1,vars:1,consts:[[3,"displayFilter","data","columnDefs"],[3,"contentChanged","displayFilter","data","columnDefs"]],template:function(n,i){n&1&&u(0,he,1,3,"lib-simple-table",0),n&2&&m(i.tableData().length?0:-1)},dependencies:[B,ne],encapsulation:2})}return t})();function ve(t,f){if(t&1&&c(0,"lib-simple-table",0),t&2){let e=l();y("displayFilter",!1)("data",e.tableData())("columnDefs",e.columnDefs)}}var ge=(()=>{class t{list=O.required();tableData=h([]);columnDefs=[];ngOnChanges(){let e=new p("sync","Sync","right");e.type=T.CHECKBOX,e.editable=!0;let n=new p("open","","center");n.type=T.HTMLELEMENT,this.columnDefs=[new p("name","Name"),new p("modified","Modified"),new p("lastSync","Last sync"),n];let i=this.list().map(a=>{let{iri:M,size:R,modified:X,lastSync:A,name:g}=a,b=document.createElement("button");return b.innerText="open",b.style.background="rgba(0,0,0,0)",b.style.border="1px solid",b.style.cursor="pointer",b.style.borderRadius="2px",b.addEventListener("click",()=>{window.open(M,"_blank")}),{id:M,size:R,modified:D(X),lastSync:D(A),name:g,open:b}});this.tableData.update(()=>[...i])}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["app-synced-list"]],inputs:{list:[1,"list"]},features:[P],decls:1,vars:1,consts:[[3,"displayFilter","data","columnDefs"]],template:function(n,i){n&1&&u(0,ve,1,3,"lib-simple-table",0),n&2&&m(i.tableData().length?0:-1)},dependencies:[B],encapsulation:2})}return t})();function Ce(t,f){if(t&1&&(s(0,"span",1),v(1,"All files are up to date. The files synced from the host application are shown below:"),r(),s(2,"div",2),c(3,"app-synced-list",3),r()),t&2){let e=l();o(3),y("list",e.syncTable())}}function xe(t,f){if(t&1){let e=w();s(0,"button",5),S("click",function(){C(e);let i=l(2);return x(i.requestList())}),v(1," Sync "),c(2,"mat-icon",6),r()}if(t&2){let e=l(2);E("pulse",e.syncInProgress())}}function we(t,f){if(t&1&&(s(0,"div",8)(1,"span"),v(2),r(),c(3,"mat-progress-bar",9),r()),t&2){let e=l(3);o(2),Q("",e.syncPct()," %"),o(),y("value",e.syncPct())}}function Se(t,f){if(t&1){let e=w();s(0,"button",5),S("click",function(){C(e);let i=l(3);return x(i.doSync())}),v(1," Confirm "),c(2,"mat-icon",10),r()}if(t&2){let e=l(3);E("pulse",e.syncInProgress())}}function Te(t,f){if(t&1){let e=w();s(0,"div",2)(1,"app-sync-list",7),S("filteredList",function(i){C(e);let a=l(2);return x(a.onFilteredListUpdated(i))}),r()(),u(2,we,4,2,"div",8)(3,Se,3,2,"button",4)}if(t&2){let e=l(2);o(),y("list",e.syncTable()),o(),m(e.syncPct()!==0?2:-1),o(),m(e.readyToSync()?3:-1)}}function Me(t,f){if(t&1&&(s(0,"span",1),v(1),c(2,"br"),v(3," Select in the list below which files to sync. "),r(),u(4,xe,3,2,"button",4)(5,Te,4,3)),t&2){let e=l();o(),W(" Received ",e.hostFileCount()," files from host and ",e.needSyncCount()," need to be synced."),o(3),m(e.syncTable().length?-1:4),o(),m(e.syncTable().length?5:-1)}}var rt=(()=>{class t{_syncService=d(re);_state=d(ie);_gtmService=d(me);syncRequest=L();syncInProgress=h(!1);syncTable=this._syncService.syncTable;syncPct=this._syncService.syncPct;hostFileCount=k(()=>this.syncTable().length);needSyncCount=k(()=>this.syncTable().filter(e=>e.outdated).length);readyToSync=k(()=>this._filteredList().length&&this.syncPct()===0);allUpToDate=k(()=>this.needSyncCount()===0);_filteredList=h([]);onSyncListReceived=te(()=>{this.syncInProgress.set(!1);let e=this.syncTable().filter(n=>n.outdated);this._filteredList.set(e)});ngOnInit(){this._gtmService.pushTag({event:"page_view",pageName:"sync"})}requestList(){let e=this._state.projectData()?.lastSync;this.syncRequest.emit({lastSync:e}),this.syncInProgress.set(!0)}doSync(){return N(this,null,function*(){this.syncInProgress.set(!0),yield this._syncService.sync(this._filteredList()),this.syncInProgress.set(!1)})}onFilteredListUpdated(e){this._filteredList.set(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["app-sync"]],outputs:{syncRequest:"syncRequest"},decls:3,vars:1,consts:[[1,"sync-container"],[1,"msg"],[1,"list"],[3,"list"],["mat-stroked-button","",3,"pulse"],["mat-stroked-button","",3,"click"],["aria-hidden","false","aria-label","Sync files","fontIcon","sync"],[3,"filteredList","list"],[1,"sync-status"],["mode","determinate",2,"width","100%",3,"value"],["aria-hidden","false","aria-label","Confirm sync","fontIcon","sync"]],template:function(n,i){n&1&&(s(0,"div",0),u(1,Ce,4,1)(2,Me,6,4),r()),n&2&&(o(),m(i.allUpToDate()?1:2))},dependencies:[se,oe,ce,le,ue,ge,fe,pe],styles:[".sync-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;justify-content:center;overflow:hidden;width:100%;height:100%;gap:.5rem}.msg[_ngcontent-%COMP%]{font-size:.7rem;padding:1rem}.list[_ngcontent-%COMP%]{overflow-y:auto;width:100%}.sync-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;padding:1rem;gap:.5 rem}.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-animation 2s infinite}@keyframes _ngcontent-%COMP%_pulse-animation{0%{box-shadow:0 0 #0003}to{box-shadow:0 0 0 20px #0000}}"]})}return t})();export{rt as SyncComponent};
