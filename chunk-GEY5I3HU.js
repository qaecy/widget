import{a as D}from"./chunk-HPSABL7M.js";import{a as ie}from"./chunk-RGY2OSYS.js";import"./chunk-A2LSBBSI.js";import{i as M,j as f,k as O}from"./chunk-7EYNGBUW.js";import{s as ne}from"./chunk-2PX35R7B.js";import{a as ce}from"./chunk-EST3HM3H.js";import"./chunk-22TYSVVA.js";import"./chunk-VY7MXYSK.js";import{M as ae,Q as oe,R as se,S as le,z as re}from"./chunk-PKQBRYZK.js";import{j as te}from"./chunk-NGJ6S4NL.js";import{Ab as s,Ka as a,Mb as b,Ob as J,P as N,Pb as Q,Q as z,Qa as G,S as d,Ta as x,Y as P,Ya as _,Yb as W,Z as v,Za as Z,_ as C,ab as Y,ac as V,bb as p,bc as E,ec as ee,fa as q,ga as U,gb as K,hb as y,ia as L,ib as A,ja as B,jb as S,ka as j,kb as $,mb as m,qa as H,rb as o,sb as r,tb as c,xb as T,zb as w}from"./chunk-SUJ2ERSS.js";import"./chunk-2MEMY2TC.js";import"./chunk-GSV7GFVO.js";import"./chunk-4JUNAGW5.js";import"./chunk-QWYGOFBQ.js";import"./chunk-VNCJOYNM.js";import"./chunk-I4ID7IWF.js";import"./chunk-36JE2O54.js";import"./chunk-DAQOROHW.js";function ge(t,u){t&1&&c(0,"div",2)}var _e=new z("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var de=(()=>{class t{_elementRef=d(j);_ngZone=d(U);_changeDetectorRef=d(W);_renderer=d(G);_cleanupTransitionEnd;_animationMode=d(H,{optional:!0});constructor(){let e=d(_e,{optional:!0});this._isNoopAnimation=this._animationMode==="NoopAnimations",e&&(e.color&&(this.color=this._defaultColor=e.color),this.mode=e.mode||this.mode)}_isNoopAnimation=!1;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";get value(){return this._value}set value(e){this._value=me(e||0),this._changeDetectorRef.markForCheck()}_value=0;get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=me(e||0),this._changeDetectorRef.markForCheck()}_bufferValue=0;animationEnd=new q;get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}_mode="determinate";ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._cleanupTransitionEnd=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._transitionendHandler)})}ngOnDestroy(){this._cleanupTransitionEnd?.()}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}_transitionendHandler=e=>{this.animationEnd.observers.length===0||!e.target||!e.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))};static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(n,i){n&2&&(K("aria-valuenow",i._isIndeterminate()?null:i.value)("mode",i.mode),$("mat-"+i.color),S("_mat-animation-noopable",i._isNoopAnimation)("mdc-linear-progress--animation-ready",!i._isNoopAnimation)("mdc-linear-progress--indeterminate",i._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",V],bufferValue:[2,"bufferValue","bufferValue",V],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[Y],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(n,i){n&1&&(o(0,"div",0),c(1,"div",1),p(2,ge,1,0,"div",2),r(),o(3,"div",3),c(4,"span",4),r(),o(5,"div",5),c(6,"span",4),r()),n&2&&(a(),A("flex-basis",i._getBufferBarFlexBasis()),a(),m(i.mode==="buffer"?2:-1),a(),A("transform",i._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height, 4px),var(--mdc-linear-progress-active-indicator-height, 4px))}@media(forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height, 4px);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-sys-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}@media(forced-colors: active){.mdc-linear-progress__buffer-dots{background-color:ButtonBorder}}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height, 4px) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0})}return t})();function me(t,u=0,e=100){return Math.max(u,Math.min(e,t))}var pe=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=Z({type:t});static \u0275inj=N({imports:[re]})}return t})();function be(t,u){if(t&1){let e=T();o(0,"lib-simple-table",1),w("contentChanged",function(i){v(e);let l=s();return C(l.onContentChange(i))}),r()}if(t&2){let e=s();y("displayFilter",!1)("data",e.tableData())("columnDefs",e.columnDefs)}}var fe=(()=>{class t{list=B.required();tableData=x([]);columnDefs=[];filteredList=L();ngOnChanges(){let e=new f("sync","Sync","right");e.type=M.CHECKBOX,e.editable=!0;let n=new f("open","","center");n.type=M.HTMLELEMENT,this.columnDefs=[new f("name","Name"),new f("modified","Modified"),n,e];let i=this.list().filter(l=>l.outdated).map(l=>{let{iri:k,size:I,modified:R,name:X}=l,g=document.createElement("button");return g.innerText="open",g.style.background="rgba(0,0,0,0)",g.style.border="1px solid",g.style.cursor="pointer",g.style.borderRadius="2px",g.addEventListener("click",()=>{window.open(k,"_blank")}),{id:k,size:I,modified:D(R),name:X,sync:!0,open:g}});this.tableData.update(()=>[...i])}onContentChange(e){let n=e.filter(l=>l.sync).map(l=>l.id),i=this.list().filter(l=>n.includes(l.iri));this.filteredList.emit(i)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["app-sync-list"]],inputs:{list:[1,"list"]},outputs:{filteredList:"filteredList"},features:[P],decls:1,vars:1,consts:[[3,"displayFilter","data","columnDefs"],[3,"contentChanged","displayFilter","data","columnDefs"]],template:function(n,i){n&1&&p(0,be,1,3,"lib-simple-table",0),n&2&&m(i.tableData().length?0:-1)},dependencies:[O,te],encapsulation:2})}return t})();function he(t,u){if(t&1&&c(0,"lib-simple-table",0),t&2){let e=s();y("displayFilter",!1)("data",e.tableData())("columnDefs",e.columnDefs)}}var ue=(()=>{class t{list=B.required();tableData=x([]);columnDefs=[];ngOnChanges(){let e=new f("sync","Sync","right");e.type=M.CHECKBOX,e.editable=!0;let n=new f("open","","center");n.type=M.HTMLELEMENT,this.columnDefs=[new f("name","Name"),new f("modified","Modified"),new f("lastSync","Last sync"),n];let i=this.list().map(l=>{let{iri:k,size:I,modified:R,lastSync:X,name:g}=l,h=document.createElement("button");return h.innerText="open",h.style.background="rgba(0,0,0,0)",h.style.border="1px solid",h.style.cursor="pointer",h.style.borderRadius="2px",h.addEventListener("click",()=>{window.open(k,"_blank")}),{id:k,size:I,modified:D(R),lastSync:D(X),name:g,open:h}});this.tableData.update(()=>[...i])}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["app-synced-list"]],inputs:{list:[1,"list"]},features:[P],decls:1,vars:1,consts:[[3,"displayFilter","data","columnDefs"]],template:function(n,i){n&1&&p(0,he,1,3,"lib-simple-table",0),n&2&&m(i.tableData().length?0:-1)},dependencies:[O],encapsulation:2})}return t})();function ve(t,u){if(t&1&&(o(0,"span",1),b(1,"All files are up to date. The files synced from the host application are shown below:"),r(),o(2,"div",2),c(3,"app-synced-list",3),r()),t&2){let e=s();a(3),y("list",e.syncTable())}}function Ce(t,u){if(t&1){let e=T();o(0,"button",5),w("click",function(){v(e);let i=s(2);return C(i.requestList())}),b(1," Sync "),c(2,"mat-icon",6),r()}if(t&2){let e=s(2);S("pulse",e.syncInProgress())}}function xe(t,u){if(t&1&&(o(0,"div",8)(1,"span"),b(2),r(),c(3,"mat-progress-bar",11),r()),t&2){let e=s(3);a(2),J("",e.syncPct()," %"),a(),y("value",e.syncPct())}}function we(t,u){if(t&1){let e=T();o(0,"button",5),w("click",function(){v(e);let i=s(3);return C(i.doSync())}),b(1," Sync "),c(2,"mat-icon",12),r()}if(t&2){let e=s(3);S("pulse",e.syncInProgress())}}function Se(t,u){if(t&1){let e=T();o(0,"div",2)(1,"app-sync-list",7),w("filteredList",function(i){v(e);let l=s(2);return C(l.onFilteredListUpdated(i))}),r()(),p(2,xe,4,2,"div",8),o(3,"div",9)(4,"button",5),w("click",function(){v(e);let i=s(2);return C(i.back())}),b(5," Back "),c(6,"mat-icon",10),r(),p(7,we,3,2,"button",4),r()}if(t&2){let e=s(2);a(),y("list",e.syncTable()),a(),m(e.syncPct()!==0?2:-1),a(2),S("pulse",e.syncInProgress()),a(3),m(e.readyToSync()?7:-1)}}function Te(t,u){if(t&1&&(o(0,"span",1),b(1),c(2,"br"),b(3," Select in the list below which files to sync. "),r(),p(4,Ce,3,2,"button",4)(5,Se,8,5)),t&2){let e=s();a(),Q(" Received ",e.hostFileCount()," files from host and ",e.needSyncCount()," need to be synced."),a(3),m(e.syncTable().length?-1:4),a(),m(e.syncTable().length?5:-1)}}var it=(()=>{class t{_syncService=d(ie);_state=d(ne);_gtmService=d(ce);syncRequest=L();syncInProgress=x(!1);syncTable=this._syncService.syncTable;syncPct=this._syncService.syncPct;hostFileCount=E(()=>this.syncTable().length);needSyncCount=E(()=>this.syncTable().filter(e=>e.outdated).length);readyToSync=E(()=>this._filteredList().length&&this.syncPct()===0);allUpToDate=E(()=>this.needSyncCount()===0);_filteredList=x([]);onSyncListReceived=ee(()=>{this.syncInProgress.set(!1);let e=this.syncTable().filter(n=>n.outdated);this._filteredList.set(e)});ngOnInit(){this._gtmService.pushTag({event:"page_view",pageName:"sync"})}requestList(){let e=this._state.projectData()?.lastSync;this.syncRequest.emit({lastSync:e}),this.syncInProgress.set(!0)}async doSync(){this.syncInProgress.set(!0),await this._syncService.sync(this._filteredList()),this.syncInProgress.set(!1)}onFilteredListUpdated(e){this._filteredList.set(e)}back(){this._state.view.set("chat")}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=_({type:t,selectors:[["app-sync"]],outputs:{syncRequest:"syncRequest"},decls:3,vars:1,consts:[[1,"sync-container"],[1,"msg"],[1,"list"],[3,"list"],["mat-stroked-button","",3,"pulse"],["mat-stroked-button","",3,"click"],["aria-hidden","false","aria-label","Sync files","fontIcon","sync"],[3,"filteredList","list"],[1,"sync-status"],[1,"btns"],["aria-hidden","false","aria-label","Back","fontIcon","arrow_back"],["mode","determinate",2,"width","100%",3,"value"],["aria-hidden","false","aria-label","Confirm sync","fontIcon","sync"]],template:function(n,i){n&1&&(o(0,"div",0),p(1,ve,4,1)(2,Te,6,4),r()),n&2&&(a(),m(i.allUpToDate()?1:2))},dependencies:[oe,ae,le,se,fe,ue,pe,de],styles:[".sync-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;justify-content:center;overflow:hidden;width:100%;height:100%;gap:.5rem}.msg[_ngcontent-%COMP%]{font-size:.7rem;padding:1rem}.list[_ngcontent-%COMP%]{overflow-y:auto;width:100%}.sync-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;padding:1rem;gap:.5 rem}.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-animation 2s infinite}@keyframes _ngcontent-%COMP%_pulse-animation{0%{box-shadow:0 0 #0003}to{box-shadow:0 0 0 20px #0000}}"]})}return t})();export{it as SyncComponent};
