import{O as n,Q as h,R as a}from"./chunk-SUJ2ERSS.js";import{a as c,b as d}from"./chunk-DAQOROHW.js";var l=new h("google-tag-manager-config"),f=(()=>{class o{constructor(e){this._googleTagManagerConfig={id:null,gtm_auth:"",gtm_preview:""},e&&this.set(e)}set(e){this._googleTagManagerConfig=e}get(){return this._googleTagManagerConfig}static{this.\u0275fac=function(t){return new(t||o)(a(l,8))}}static{this.\u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var _=(()=>{class o{constructor(e,t,r="noisy",i,g,s,u){this.googleTagManagerConfiguration=e,this.googleTagManagerId=t,this.googleTagManagerMode=r,this.googleTagManagerAuth=i,this.googleTagManagerPreview=g,this.googleTagManagerResourcePath=s,this.googleTagManagerCSPNonce=u,this.isLoaded=!1,this.browserGlobals={windowRef(){return window},documentRef(){return document}},this.config=this.googleTagManagerConfiguration?.get(),this.config==null&&(this.config={id:null}),this.config=d(c({},this.config),{id:t||this.config.id,gtm_auth:i||this.config.gtm_auth,gtm_preview:g||this.config.gtm_preview,gtm_resource_path:s||this.config.gtm_resource_path}),this.config.id!=null}checkForId(){if(this.googleTagManagerMode!=="silent"&&!this.config.id)throw new Error("Google tag manager ID not provided.");return!!this.config.id}getDataLayer(){this.checkForId();let e=this.browserGlobals.windowRef();return e.dataLayer=e.dataLayer||[],e.dataLayer}pushOnDataLayer(e){this.checkForId(),this.getDataLayer().push(e)}addGtmToDom(){return new Promise((e,t)=>{if(this.isLoaded)return e(this.isLoaded);if(!this.checkForId())return e(!1);let r=this.browserGlobals.documentRef();this.pushOnDataLayer({"gtm.start":new Date().getTime(),event:"gtm.js"});let i=r.createElement("script");i.id="GTMscript",i.async=!0,i.src=this.applyGtmQueryParams(this.config.gtm_resource_path?this.config.gtm_resource_path:"https://www.googletagmanager.com/gtm.js"),i.addEventListener("load",()=>e(this.isLoaded=!0)),i.addEventListener("error",()=>t(!1)),this.googleTagManagerCSPNonce&&i.setAttribute("nonce",this.googleTagManagerCSPNonce),r.head.insertBefore(i,r.head.firstChild)})}pushTag(e){return new Promise((t,r)=>{if(!this.checkForId())return t();if(!this.isLoaded)this.addGtmToDom().then(()=>(this.pushOnDataLayer(e),t())).catch(()=>r());else return this.pushOnDataLayer(e),t()})}applyGtmQueryParams(e){return e.indexOf("?")===-1&&(e+="?"),e+Object.keys(this.config).filter(t=>this.config[t]).map(t=>`${t}=${this.config[t]}`).join("&")}static{this.\u0275fac=function(t){return new(t||o)(a(f,8),a("googleTagManagerId",8),a("googleTagManagerMode",8),a("googleTagManagerAuth",8),a("googleTagManagerPreview",8),a("googleTagManagerResourcePath",8),a("googleTagManagerCSPNonce",8))}}static{this.\u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{_ as a};
